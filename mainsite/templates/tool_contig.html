{% extends "base.html" %}

{% block head %}
<title>Metagenomics Clone Bank</title>

<script type="text/javascript" src="/usr/local/lib/python2.7/dist-packages/jquery/static/jquery"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $("select#pool").submit(function(event){
                $.ajax({
                    type:"POST",
                    url:"/contigtool/",
                    data: {'pool': $('#pool').find(":selected").text()},
                });
            });
        }); 
    </script>

{% endblock %}

{% block pagetitle %}
    <title>Contig Retrieval Tool</title>
{% endblock %}

{% block subtitle %}
    <h1>Contig Retrieval Tool</h1>
{% endblock %}

{% block content %}
<section id="tool1">
    <table>

    <form action="{% url "contig" %}" method="POST" enctype="multipart/form-data">{% csrf_token %}
    <tr><th>Select Pool</th>
        <td><select id="pool" name="pool">
            {% for entry in pool %}
                <option value="{{entry.id}}"> {{entry.id}}</option>
            {% endfor %}
        </select></td>
        <td><input type="submit" name="detail" value="Display Pool" /></td>
    </tr>
            {% for selected in detail %}
                <tr><th>Selected Pool</th><td>{{selected.id}}</td></tr>
                <tr><th>Service Provider</th><td>{{selected.service_provider}}</td></tr>
                <tr><th>Max Clones for Pool</th><td>{{selected.max_number}}</td></tr>
                <tr><th>NCBI SRA Accession</th><td>{{selected.ncbi_sra_accession}}</td></tr>
                <tr><th>Comments</th><td>{{selected.pool_comments}}</td></tr>
            {% endfor %}
    </table>
</section>    
{% endblock %}

{% block second %}
<section id="tool2">
        
    <table>
        
        <tr><th>Select Cosmids</th><th>Cosmids in Pool</th>
        <input type="submit" name="submit" value="Submit"/></tr>
        {% for cos in cosmids%}
            {% for contig in contigs %}
                {% for cosmid in contig.cosmid.all %}
                    {% ifequal cos cosmid %}
                    <tr><td></td><td>{{cosmid}}</td></tr>
                    {% else%}
                    <tr><td><input type="checkbox" name="cos" value="{{cos}}" checked>{{cos}}</input></td><td></td></tr>
                    {% endifequal %}
                {% endfor %}     
            {% endfor %}
        {% endfor %}
    </table>  
    
        </form>
    </table>
</section>
{% endblock %}